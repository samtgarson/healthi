function homeFunc() {
    $(".slider-nav ul").pep({
        axis: "x",
        velocityMultiplier: 0,
        removeMargins: !1,
        stop: dragStop,
        drag: dragDuring,
        cssEaseDuration: 300,
        cssEaseString: "easeOutExpo",
        useCSSTranslation: !1,
        shouldEase: !1,
        callIfNotStarted: []
    }), $(".slider-content").pep({
        axis: "x",
        velocityMultiplier: 0,
        removeMargins: !1,
        stop: pageDragStop,
        drag: pageDragDuring,
        cssEaseDuration: 300,
        cssEaseString: "easeOutExpo",
        useCSSTranslation: !1,
        shouldEase: !1,
        callIfNotStarted: []
    });
    var dragged = 0;
    $(".slider-nav li").on("touchstart mousedown", function() {
        dragged = 0, $(this).on("touchmove mousemove", function() {
            dragged = 1;
        });
    }).on("touchend mouseup", function() {
        dragged || slideAll($(this).index());
    });
}

function dragStop() {
    var navArray = [ 0, -79, -158, -237 ], navTarget = parseInt($(".selector ul").css("marginLeft")), navIndex = nearest(navTarget, navArray)[1];
    return slideAll(navIndex), !1;
}

function pageDragStop() {
    var pageArray = [ 0, -100, -200, -300 ], pageTarget = parseInt($(".slider-content").css("left")) / $(".slider-content").width(), pageIndex = nearest(400 * pageTarget, pageArray)[1];
    return slideAll(pageIndex), !1;
}

function dragDuring() {
    var l = parseInt($(".slider-nav ul").css("left")) - $("body").width() / 2;
    $(".selector ul").css("marginLeft", l - 2);
    var dragPercent = parseFloat($(".selector ul").css("margin-left")) / $(".slider-nav ul").width(), pageMargin = $(".slider-content").width() * dragPercent;
    $(".slider-content").css("left", pageMargin);
}

function pageDragDuring() {
    var bodyW = $("body").width() / 2, dragPercent = parseInt($(".slider-content").css("left")) / $(".slider-content").width(), selectMargin = dragPercent * $(".slider-nav ul").width(), navMargin = bodyW + selectMargin;
    $(".slider-nav ul").css("left", navMargin), $(".selector ul").css("marginLeft", selectMargin - 2);
}

function nearest(num, arr) {
    var i = 0, res = arr.reduce(function(prev, curr) {
        return Math.abs(curr - num) < Math.abs(prev - num) ? (i++, curr) : prev;
    });
    return [ res, i ];
}

function slideAll(index) {
    var r = -79 * index, m = $("body").width() / 2 + r, e = "easeOutExpo", time = 700, pageMargin = 100 * index;
    $(".slider-content").animate({
        left: "-" + pageMargin + "%"
    }, time, e), $(".selector ul").animate({
        marginLeft: r
    }, time, e), $(".slider-nav ul").animate({
        left: m
    }, time, e);
    var newTitle = $(".slidee").eq(index).attr("class").split("slidee ")[1];
    newTitle != view.title && (console.log(newTitle), view.title = newTitle, $("footer").toggleClass("action"));
}

function pageReady() {
    this.$watch("name", function(newValue) {
        this.title = newValue, console.log("changingTitle");
    }), this.$watch("title", this.$parent.changeTitle), this.loadContent();
}

function changePage(item) {
    var newPage = item.$value;
    $("#" + newPage).hasClass("current") ? this.closeMenu() : ($("section.main").empty(), 
    view.viewData = {}, view.name = newPage, this.closeMenu(), view.loadContent());
}

function loadContent() {
    var file = "build/templates/" + this.name + ".html";
    $.get(file, function(html) {
        $("section.main").html(html);
    }).done(function() {
        setTimeout(function() {
            eval(view.name + "Func()");
        }, 400);
    });
}

function appReady() {}

function closeMenu() {
    view.title = view.name, this.menuOpen = !1;
}

function openMenu() {
    this.menuOpen = !0, $(".current").removeClass("current"), $("#" + view.name).addClass("current"), 
    view.title = "menu";
}

function changeTitle(newTitle) {
    $("h1#title span").addClass("old"), $("h1#title").prepend("<span class='new'>" + newTitle + "</span>"), 
    setTimeout(function() {
        $(".new").css("margin-top", 0), setTimeout(function() {
            $(".old").remove(), $("span.new").removeClass("new");
        }, 400);
    }, 0);
}

Vue.component("Page", {
    template: "hello",
    ready: pageReady,
    data: {
        name: "home",
        title: "home",
        viewData: {}
    },
    methods: {
        loadContent: loadContent
    }
});

var app = new Vue({
    el: "body",
    ready: appReady,
    data: {
        menuOpen: !1,
        views: [ "home", "settings" ]
    },
    methods: {
        toggleMenu: function() {
            this.menuOpen ? this.closeMenu() : this.openMenu();
        },
        closeMenu: closeMenu,
        changeTitle: changeTitle,
        openMenu: openMenu,
        changePage: changePage
    }
}), view = app.$.pageref;